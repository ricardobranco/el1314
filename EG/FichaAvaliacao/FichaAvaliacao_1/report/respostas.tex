\section{Respostas}
\label{sub:alinea_a}
\textbf{a) Escreva uma frase válida da linguagem gerada pela GIC dada, mostrando a respectiva Árvore de Derivação.}\\
Uma frase válida da linguagem gerada pela GIC dada no enunciado do problema é:

\begin{verbatim}
[
	REGISTO r1 :
	BAUM - LIVRO - "Game Of Thrones"
	("George R.R. Martin") "Bang" - 2007
	EXISTENCIAS
	baum_gt_28 PERMANENTE ,
	bgum_gt_62 EMPRESTADO 2014-5-10
],
[
	REGISTO r2 :
	BGUM - CDROM - "Abbey Road"
	("Beatles") "Apple Records" - 1969
	EXISTENCIAS
	bgum_arbeat_85 PERMANENTE
]
\end{verbatim}

Na figura ~\ref{fig:alinea_a} pode-se ver como é a árvore de derivação da frase apresentada.

\begin{figure}[!h]
	\centering
    \includegraphics[width=0.9\textwidth]{./imagens/alineaa.png}
    \caption{Árvore de Derivação}
    \label{fig:alinea_a}
\end{figure}

\label{sub:alinea_b}

\textbf{b) Altere a gramáatica de modo a permitir que cada livro tenha mais de um Autor.}\\
De forma a premitir que um livro tenha mais de que um autor, foram feitas as seguintes alterações:
\textbf{Antes}
\begin{verbatim}
Descricao   --> Referencia ':' Catalogo '-' Tipo '-' Titulo '(' Autores ')' Editora '-' Ano

\end{verbatim}
\textbf{Depois}
\begin{verbatim}
Descricao   --> Referencia ':' Catalogo '-' Tipo '-' Titulo '(' Autor ')' Editora '-' Ano

Autores     --> Autor
              | Autores ',' Autor

\end{verbatim}

Com esta nova gramática, frases como a que seguem tornam-se válidas.

\begin{verbatim}
[
	REGISTO r1 :
	BAUM - LIVRO - "Uma Aventura Na Serra da Estrela"
	("Isabel Alçada","Ana Maria Magalhães") "Caminho" - 2010
	EXISTENCIAS
	baum_avent_28 ESTANTE ,
	bgum_avent_62 EMPRESTADO 2014-5-10
]
\end{verbatim}
Quanto a árvore de derivação, está é representada da seguinte maneira:

\begin{figure}[!h]
	\centering
    \includegraphics[width=\textwidth]{./imagens/alineab.png}
    \caption{Árvore de Derivação para uma GIC que suporta múltiplos autores}
    \label{fig:alinea_b}
\end{figure}

\label{sub:alinea_c}

\textbf{c) O par de produções p1/p2 define uma lista com recursividade à esquerda. Altere esse par para usarrecursividade à direita e mostre, através das árvores de derivação, a diferença entre ambos os esquemas iterativos.}\\

De forma a permitir que o par de produções \textbf{p1/p2} definam uma lista com recursividade à direita, alterou-se a GIC da seguite forma:

\begin{verbatim}
Registos  --> Registo
            | Registo ',' Registos
\end{verbatim}

Essa alteração implicou mudanças na árvore de derivação. Usando a frase usada na  \hyperref[sub:alinea_a]{questão A} obteve-se a árvore de derivação representada na figura ~\ref{fig:alinea_a} como sendo exemplo de uma lista com recursividade à esquerda. Numa lista com recursividade à direita a árvore de derivação seria a seguinte:

\begin{figure}[!h]
	\centering
    \includegraphics[width=0.9\textwidth]{./imagens/alineac.png}
    \caption{Árvore de Derivação para listas com recursividade à direita}
    \label{fig:alinea_c}
\end{figure}
Comparando as duas árvores conclui-se que no caso da gramática constituida por listas com recursividade à esquerda, a árvore de derivação tende a crescer para o lado esquerdo. No caso da gramática constituida por listas com recursividade à direita, a árvore de derivação tende a crescer para o lado direito.
\newpage
\textbf{d) Escreva as funções de um parser RD-puro (recursivo-descendente) para reconhecer o Símbolo Existencias e seus derivados, isto é, os símbolos que apareçam no lado direito das produções.}\\
\label{sub:alinea_d}

No Apêndice ~\ref{sec:parser_recursivo_descedente} estão as funções respetivas a um paser RD-puro(recursivo-descendente), com o objetivo de reconhecer o Símbolo \emph{Existencias}.

No caso dos simbolos não-terminais usa-se a função \emph{void rec\_N(s)}, em que \emph{N} é o símbolo não-terminal que se quer reconhecer e \emph{s} o próximo simbolo a analisar. O objetivo é verificar para cada produção \emph{p} de \emph{N} se \emph{s} faz parte do \emph{lookahead} de \emph{p}(\emph{la(p)}), caso não acontece é retornado um erro.
No caso dos simbolo terminais usa-se a função \emph{void rec\_T(s)}, em que \emph{T} é o simbolo terminal que se quer reconhecer e \emph{s} o próximo simbolo a analisar. O objetivo é verifcar \emph{s} é igual ao simbolo terminal \emph{T} ou se faz \emph{match} com \emph{T} no caso dos simbolos terminais variáveis \emph{match\_T(s)}. Caso \emph{s} seja reconhecido, este passa a ter o valor do próximo símbolo a analisar, caso contrário é retornado um erro.
\\
\textbf{e) Construa o estado inicial do autómato LR(0) para gramática dada e os estados que dele saem.}\\
\label{sub:alinea_e}

O estado inical do autómato LR(0) para a GIC apresentada é:

\begin{verbatim}
[Z -> . Biblioteca $]
----------------------------------------------------------------
[Biblioteca -> . Registo]
[Registos -> . Registos]
[Registos -> . Registos ',' Registo]
[Registo -> . '[' REGISTO Descricao EXISTENCIAS Existencias ']']
\end{verbatim}

\textbf{f) No sentido de começar a avaliar a qualidade desta gramática calcule algumas métricas de tamanho
sobre ela: número de símbolos de cada tipo; número de produções; número de produções unitárias;
comprimento médio e máximo dos lados direitos das produções; ...}\\
\label{sub:alinea_f}

Na tabela ~\ref{table:alinea_g} monstra-se as medidas que permitem avaliar a GIC apresentada.

\begin{table}[h!]
  \begin{center}
    \begin{tabular}{|l|r|l|}
    \hline
    \textbf{Métrica} & \textbf{Medida} & \textbf{Observações}\\
    \hline
     \#T & 20 & = 3(TV) + 10(PR) + 7(Sin)\\
     \#N & 18 & \\
     \#P & 26 & \\
     \#PU & 18 & S $\not \subseteq PU$ portanto $p0 \notin PU$ \\
     \textsection RHS& 2,038 & 53/26 \\
     \textsection RHS-Max &13 & p4 \\
    \hline
    \end{tabular}
  \end{center}
  \label{table:alinea_g}
  \caption{Métricas sobre a GIC}
\end{table}
Legenda:
\begin{description}
	\item[\#T] Nº de Símbolos Terminais\\
	\item[TV] Terminais Váriaveis\\
	\item[PR] Palavras Reservadas\\
	\item[Sin] Sinais de Pontuação\\
	\item[\#N] Símbolos Não-Terminais\\
	\item[\#P] Nº de Produções\\
	\item[\#PU] Nº de Produções Unitárias\\
	\item[\textsection RHS] Comprimento médio do lado direito das produções (\emph{Right Hand Size})\\
	\item[\textsection RHS-Max] Comprimento máximo do lado direito das produções\\
\end{description}
\textbf{g) Transforme a GIC dada numa gramática de atributos, GA, reconhecível pelo AnTLR, para:
\begin{itemize}
\item calcular e imprimir: o número de registos; e o número de livros existentes para cada registo.
\item calcular o número total de livros com estado PERMANENTE.
\item identificar e listar por ordem alfabética os títulos dos livros.
\item verificar se não existem registos com a mesma referência.
\end{itemize}}
\label{sub:alinea_g}
No Apêndice ~\ref{sec:gramatica_atributos} está presente a gramática de atributos reconhecida pelo AnTLR. Respectivamente à mesma gramática optou-se por criar duas classes auxiliares \emph{Registo} e \emph{Registos} com o objetivo de tornar a gramática mais legível. Os atributos herdados foram escritos na forma \emph{in\_*} e os atributos sintetizados foram escritos na forma \emph{out\_*}.\\
Também recorreu-se ao VisualLisa para representar a mesma gramática sob forma visual, tal como se pode ver no Apêndice ~\ref{sec_gramatica_atributos_visual}.

\begin{figure}[!h]
	\centering
    \includegraphics[width=0.9\textwidth]{./imagens/VisualLisa/__Biblioteca.png}
    \caption{Produções da Gramática}
    \label{fig:Producoes}
\end{figure}





